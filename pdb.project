<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Poultry Farming Database - Login</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f2f2f2;
        padding: 20px;
    }

    h1 {
        text-align: center;
        color: #2c3e50;
    }

    .container {
        width: 85%;
        margin: auto;
        background: #ffffff;
        padding: 20px;
        box-shadow: 0 0 10px rgba(0,0,0,0.2);
        border-radius: 8px;
    }

    .form-group {
        text-align: center;
        margin-bottom: 15px;
    }

    input {
        padding: 8px;
        margin: 5px;
        width: 160px;
    }

    button {
        padding: 8px 15px;
        background-color: #27ae60;
        color: white;
        border: none;
        cursor: pointer;
        border-radius: 4px;
    }

    button:hover {
        background-color: #219150;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }

    th, td {
        border: 1px solid #ccc;
        padding: 10px;
        text-align: center;
    }

    th {
        background-color: #27ae60;
        color: white;
    }

    .delete-btn {
        background-color: red;
        padding: 5px 10px;
        border: none;
        color: white;
        cursor: pointer;
        border-radius: 3px;
    }

    .delete-btn:hover {
        background-color: darkred;
    }

    /* Login Box */
    .login-box {
        width: 300px;
        margin: 100px auto;
        background: white;
        padding: 25px;
        border-radius: 8px;
        text-align: center;
        box-shadow: 0 0 10px rgba(0,0,0,.2);
    }
</style>
</head>
<body>

<!-- ========== LOGIN SECTION ========== -->
<div id="loginSection" class="login-box">
    <h2>üêî Poultry Database Login</h2>
    <input type="text" id="username" placeholder="Username"><br>
    <input type="password" id="password" placeholder="Password"><br>
    <button onclick="login()">Login</button>
    <p id="msg"></p>
</div>

<!-- ========== MAIN APP SECTION ========== -->
<div id="appSection" style="display:none;">

<h1>üêî Poultry Farming Database 
<button onclick="logout()" style="float:right;background:red;">Logout</button>
</h1>

<div class="container">

    <div class="form-group">
        <input type="text" id="batch" placeholder="Batch Name">
        <input type="number" id="chicks" placeholder="No. of Chicks">
        <input type="text" id="feed" placeholder="Feed Type">
        <input type="number" id="mortality" placeholder="Mortality">
        <input type="date" id="date">
        <br><br>
        <button onclick="addRecord()">Add Record</button>
    </div>

    <table>
        <thead>
            <tr>
                <th>Batch</th>
                <th>Chicks</th>
                <th>Feed</th>
                <th>Mortality</th>
                <th>Live Birds</th>
                <th>Date</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="tableBody"></tbody>
    </table>

</div>
</div>

<script>
// ================= LOGIN SYSTEM =================

// Create default account if not exists
if (!localStorage.getItem("userAccount")) {
    localStorage.setItem("userAccount", JSON.stringify({
        username: "admin",
        password: "1234"
    }));
}

// Check login status on page load
window.onload = function(){
   if(localStorage.getItem("loggedIn") === "true"){
       showApp();
   }
};

function login(){
    let u = document.getElementById("username").value;
    let p = document.getElementById("password").value;

    let account = JSON.parse(localStorage.getItem("userAccount"));

    if(u === account.username && p === account.password){
        localStorage.setItem("loggedIn","true");
        showApp();
    } else {
        document.getElementById("msg").innerText = "‚ùå Invalid Username or Password";
    }
}

function logout(){
    localStorage.removeItem("loggedIn");
    location.reload();
}

function showApp(){
    document.getElementById("loginSection").style.display="none";
    document.getElementById("appSection").style.display="block";
    displayData();
}

// ================= POULTRY DATABASE =================

let poultryData = JSON.parse(localStorage.getItem("poultryData")) || [];

function addRecord() {
    let batch = document.getElementById("batch").value;
    let chicks = document.getElementById("chicks").value;
    let feed = document.getElementById("feed").value;
    let mortality = document.getElementById("mortality").value;
    let date = document.getElementById("date").value;

    if (batch === "" || chicks === "" || feed === "" || mortality === "" || date === "") {
        alert("Please fill all fields");
        return;
    }

    if (chicks <= 0 || mortality < 0) {
        alert("Invalid numbers entered");
        return;
    }

    if (parseInt(mortality) > parseInt(chicks)) {
        alert("Mortality cannot exceed number of chicks");
        return;
    }

    let record = { batch, chicks, feed, mortality, date };

    poultryData.push(record);
    localStorage.setItem("poultryData", JSON.stringify(poultryData));

    displayData();
    clearForm();
}

function displayData() {
    let tableBody = document.getElementById("tableBody");
    tableBody.innerHTML = "";

    // Sort newest date first
    poultryData.sort((a,b)=> new Date(b.date) - new Date(a.date));

    poultryData.forEach((data, index) => {
        let live = data.chicks - data.mortality;
        tableBody.innerHTML += `
            <tr>
                <td>${data.batch}</td>
                <td>${data.chicks}</td>
                <td>${data.feed}</td>
                <td>${data.mortality}</td>
                <td>${live}</td>
                <td>${data.date}</td>
                <td>
                    <button class="delete-btn" onclick="deleteRecord(${index})">Delete</button>
                </td>
            </tr>
        `;
    });
}

function deleteRecord(index) {
    poultryData.splice(index, 1);
    localStorage.setItem("poultryData", JSON.stringify(poultryData));
    displayData();
}

function clearForm() {
    document.getElementById("batch").value = "";
    document.getElementById("chicks").value = "";
    document.getElementById("feed").value = "";
    document.getElementById("mortality").value = "";
    document.getElementById("date").value = "";
}
</script>

</body>
</html>
